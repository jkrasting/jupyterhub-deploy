# docker-compose.yml (v2.5 - Explicit Network Name)
version: "3.8"

services:
  jupyterhub:
    build: .
    container_name: jupyterhub_service
    restart: unless-stopped

    environment:
      JUPYTERHUB_CRYPT_KEY: ${JUPYTERHUB_CRYPT_KEY}
      OAUTH_CLIENT_ID: ${OAUTH_CLIENT_ID}
      OAUTH_CLIENT_SECRET: ${OAUTH_CLIENT_SECRET}
      OIDC_ISSUER: ${OIDC_ISSUER}
      OAUTH_AUTHORIZE_URL: ${OAUTH_AUTHORIZE_URL}
      OAUTH_TOKEN_URL: ${OAUTH_TOKEN_URL}
      OAUTH_USERDATA_URL: ${OAUTH_USERDATA_URL}

    command: jupyterhub -f /etc/jupyterhub/jupyterhub_config.py

    ports:
      - "8088:8000"

    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - jupyterhub-data:/srv/jupyterhub

    networks:
      - jupyterhub-network

networks:
  jupyterhub-network:
    # THIS IS THE FIX:
    # Explicitly name the network to prevent a stack prefix.
    name: jupyterhub-network

volumes:
  jupyterhub-data:
